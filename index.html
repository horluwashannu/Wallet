<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Multi-Network Airdrop Claim DApp</title>

<script src="https://cdn.tailwindcss.com"></script>

<!-- Ethers.js -->
<script src="https://cdn.jsdelivr.net/npm/ethers@5.7.2/dist/ethers.min.js"></script>

<!-- Web3Modal and Wallet Providers -->
<script src="https://unpkg.com/web3modal@1.9.12/dist/index.js"></script>
<script src="https://unpkg.com/@walletconnect/web3-provider@1.8.0/dist/umd/index.min.js"></script>
<script src="https://unpkg.com/@coinbase/wallet-sdk@3.8.0/dist/CoinbaseWalletSDK.min.js"></script>

<style>
  body {
    margin: 0;
    background: linear-gradient(-45deg, #6d28d9, #9333ea, #3b82f6, #2563eb);
    background-size: 400% 400%;
    animation: gradientMove 20s ease infinite;
    font-family: 'Poppins', sans-serif;
    color: #e0e7ff;
    min-height: 100vh;
    display: flex;
    justify-content: center;
    align-items: center;
    padding: 1rem;
  }
  @keyframes gradientMove {
    0% { background-position: 0% 50%; }
    50% { background-position: 100% 50%; }
    100% { background-position: 0% 50%; }
  }
  #app {
    background: rgba(0, 0, 30, 0.8);
    backdrop-filter: blur(12px);
    border-radius: 20px;
    max-width: 600px;
    width: 100%;
    box-shadow: 0 0 30px rgba(110, 49, 250, 0.6);
    padding: 2rem;
    text-align: center;
  }
  h1 {
    font-weight: 900;
    font-size: 2.5rem;
    margin-bottom: 0.5rem;
    text-shadow: 0 2px 8px #9333ea99;
  }
  p {
    font-size: 1.1rem;
    margin-bottom: 1.2rem;
    opacity: 0.9;
  }
  button {
    font-size: 1.2rem;
    padding: 1rem 1.5rem;
    border-radius: 15px;
    border: none;
    cursor: pointer;
    font-weight: 700;
    box-shadow: 0 0 15px #9333eaaa;
    background: linear-gradient(90deg, #7c3aed, #c084fc);
    color: white;
    user-select: none;
    transition: all 0.3s ease;
  }
  button:disabled {
    background: #4c1d95aa;
    cursor: not-allowed;
    box-shadow: none;
    color: #c4b5fd88;
  }
  #accountDisplay, #networkDisplay {
    font-family: "Courier New", Courier, monospace;
    color: #d8b4fecc;
    font-weight: 600;
    font-size: 1rem;
    margin-top: 1rem;
    user-select: text;
  }
  #statusMsg {
    font-size: 1rem;
    margin-top: 1rem;
    min-height: 1.2rem;
    color: #fbbf24cc;
    font-weight: 700;
    user-select: none;
    text-shadow: 0 0 8px #fbbf2488;
  }
  #fakeNotif {
    position: fixed;
    bottom: 2rem;
    right: 2rem;
    background: rgba(147, 51, 234, 0.9);
    color: white;
    font-weight: 700;
    padding: 1rem 1.4rem;
    border-radius: 12px;
    font-size: 1rem;
    box-shadow: 0 0 20px #c084fc;
    animation: slideUpFade 3.5s ease forwards;
    opacity: 0;
    pointer-events: none;
    user-select: none;
    max-width: 320px;
    z-index: 9999;
  }
  #fakeNotif.show {
    opacity: 1;
    pointer-events: auto;
  }
  @keyframes slideUpFade {
    0% { transform: translateY(30px); opacity: 0; }
    10%, 90% { transform: translateY(0); opacity: 1; }
    100% { transform: translateY(-20px); opacity: 0; }
  }
</style>
</head>
<body>
  <main id="app" role="main" aria-label="Airdrop Claim Application">
    <h1>Multi-Network Airdrop Claim</h1>
    <p>Connect your wallet on any supported network (Ethereum, BSC, Polygon, Avalanche, Arbitrum, Optimism) mainnet or testnet, and claim your tokens securely.</p>

    <button id="connectBtn" aria-live="polite" aria-disabled="false">Connect Wallet</button>
    <button id="claimBtn" disabled aria-live="polite" aria-disabled="true" title="Connect your wallet to claim tokens.">ðŸ”’ Connect to Claim</button>

    <div id="networkDisplay" aria-live="polite" aria-atomic="true"></div>
    <div id="accountDisplay" aria-live="polite" aria-atomic="true"></div>
    <div id="statusMsg" aria-live="polite" aria-atomic="true"></div>
  </main>

  <div id="fakeNotif" role="alert" aria-live="assertive" aria-atomic="true"></div>

<script>
(async function() {
  // Config: replace these placeholders with your real data
  const CONFIG = {
    CONTRACT_ADDRESS: "YOUR_CONTRACT_ADDRESS",
    CONTRACT_ABI: [/* Paste your contract ABI JSON array here */],
    TELEGRAM_WEBHOOK: "YOUR_TELEGRAM_BOT_API_URL",
    TELEGRAM_CHAT_ID: "YOUR_TELEGRAM_CHAT_ID",
    DISCORD_WEBHOOK: "YOUR_DISCORD_WEBHOOK_URL",
  };

  // Supported chains with details (mainnet and testnets)
  const CHAINS = {
    1:   { name: "Ethereum Mainnet", explorer: "https://etherscan.io/tx/" },
    5:   { name: "Ethereum Goerli Testnet", explorer: "https://goerli.etherscan.io/tx/" },
    56:  { name: "BSC Mainnet", explorer: "https://bscscan.com/tx/" },
    97:  { name: "BSC Testnet", explorer: "https://testnet.bscscan.com/tx/" },
    137: { name: "Polygon Mainnet", explorer: "https://polygonscan.com/tx/" },
    80001:{ name: "Polygon Mumbai Testnet", explorer: "https://mumbai.polygonscan.com/tx/" },
    43114:{ name: "Avalanche Mainnet", explorer: "https://snowtrace.io/tx/" },
    43113:{ name: "Avalanche Fuji Testnet", explorer: "https://testnet.snowtrace.io/tx/" },
    42161:{ name: "Arbitrum One", explorer: "https://arbiscan.io/tx/" },
    421613:{ name: "Arbitrum Goerli Testnet", explorer: "https://goerli.arbiscan.io/tx/" },
    10:  { name: "Optimism Mainnet", explorer: "https://optimistic.etherscan.io/tx/" },
    420:  { name: "Optimism Goerli Testnet", explorer: "https://goerli-optimism.etherscan.io/tx/" }
  };

  // UI elements
  const connectBtn = document.getElementById("connectBtn");
  const claimBtn = document.getElementById("claimBtn");
  const networkDisplay = document.getElementById("networkDisplay");
  const accountDisplay = document.getElementById("accountDisplay");
  const statusMsg = document.getElementById("statusMsg");
  const fakeNotif = document.getElementById("fakeNotif");

  // Web3Modal setup
  const providerOptions = {
    walletconnect: {
      package: window.WalletConnectProvider.default,
      options: {
        rpc: {
          1: "https://mainnet.infura.io/v3/YOUR_INFURA_ID",
          5: "https://goerli.infura.io/v3/YOUR_INFURA_ID",
          56: "https://bsc-dataseed.binance.org/",
          97: "https://data-seed-prebsc-1-s1.binance.org:8545/",
          137: "https://polygon-rpc.com/",
          80001: "https://rpc-mumbai.maticvigil.com",
          43114: "https://api.avax.network/ext/bc/C/rpc",
          43113: "https://api.avax-test.network/ext/bc/C/rpc",
          42161: "https://arb1.arbitrum.io/rpc",
          421613: "https://goerli-rollup.arbitrum.io/rpc",
          10: "https://mainnet.optimism.io",
          420: "https://goerli.optimism.io"
        }
      }
    },
    coinbasewallet: {
      package: CoinbaseWalletSDK,
      options: {
        appName: "Multi-Network Airdrop Claim DApp",
        infuraId: "YOUR_INFURA_ID", // Optional
        rpc: "",
        chainId: 1,
        darkMode: false
      }
    }
  };

  const web3Modal = new window.Web3Modal.default({
    cacheProvider: true,
    providerOptions
  });

  let web3Provider = null;
  let signer = null;
  let contract = null;

  // Helper: Show notification
  function showNotification(msg, type = "success") {
    fakeNotif.textContent = msg;
    fakeNotif.style.backgroundColor = type === "error" ? "#dc2626" : "rgba(147, 51, 234, 0.9)";
    fakeNotif.classList.add("show");
    setTimeout(() => fakeNotif.classList.remove("show"), 3500);
  }

  // Update UI when disconnected
  function resetUI() {
    networkDisplay.textContent = "";
    accountDisplay.textContent = "";
    statusMsg.textContent = "Connect your wallet";
    claimBtn.disabled = true;
    claimBtn.title = "Connect your wallet to claim tokens.";
    connectBtn.textContent = "Connect Wallet";
  }

  // Check if chainId is supported
  function isSupportedChain(chainId) {
    return Object.hasOwnProperty.call(CHAINS, chainId);
  }

  // Setup contract instance
  function setupContract() {
    contract = new ethers.Contract(CONFIG.CONTRACT_ADDRESS, CONFIG.CONTRACT_ABI, signer);
  }

  // Connect wallet handler
  async function connectWallet() {
    try {
      const instance = await web3Modal.connect();
      web3Provider = new ethers.providers.Web3Provider(instance);
      signer = web3Provider.getSigner();

      // Listen for network changes
      instance.on("chainChanged", (chainIdHex) => {
        const chainId = parseInt(chainIdHex, 16);
        onNetworkChanged(chainId);
      });

      // Listen for accounts changed
      instance.on("accountsChanged", (accounts) => {
        if (accounts.length === 0) {
          disconnectWallet();
        } else {
          accountDisplay.textContent = accounts[0];
        }
      });

      // Detect current network
      const network = await web3Provider.getNetwork();
      const chainId = network.chainId;

      if (!isSupportedChain(chainId)) {
        statusMsg.textContent = `Unsupported network: Chain ID ${chainId}. Please switch your wallet network.`;
        claimBtn.disabled = true;
        claimBtn.title = "Switch to supported network";
        networkDisplay.textContent = `Connected network: Unknown (${chainId})`;
        accountDisplay.textContent = await signer.getAddress();
        connectBtn.textContent = "Disconnect Wallet";
        return;
      }

      // Supported network - proceed
      setupContract();

      const userAddress = await signer.getAddress();
      accountDisplay.textContent = userAddress;
      networkDisplay.textContent = `Connected network: ${CHAINS[chainId].name}`;
      statusMsg.textContent = "Wallet connected and network supported.";
      connectBtn.textContent = "Disconnect Wallet";
      claimBtn.disabled = false;
      claimBtn.title = "Click to claim your tokens";
    } catch (error) {
      statusMsg.textContent = "Could not connect wallet: " + (error.message || error);
      resetUI();
    }
  }

  // Disconnect wallet
  async function disconnectWallet() {
    if (web3Modal) {
      await web3Modal.clearCachedProvider();
    }
    web3Provider = null;
    signer = null;
    contract = null;
    resetUI();
  }

  // Handle network change
  async function onNetworkChanged(chainId) {
    if (!isSupportedChain(chainId)) {
      statusMsg.textContent = `Unsupported network: Chain ID ${chainId}. Please switch your wallet network.`;
      claimBtn.disabled = true;
      claimBtn.title = "Switch to supported network";
      networkDisplay.textContent = `Connected network: Unknown (${chainId})`;
      return;
    }
    statusMsg.textContent = `Network changed to ${CHAINS[chainId].name}.`;
    networkDisplay.textContent = `Connected network: ${CHAINS[chainId].name}`;
    claimBtn.disabled = false;
    claimBtn.title = "Click to claim your tokens";
    setupContract();
  }

  // Claim tokens function (sample simple call, replace method name/params as needed)
  async function claimTokens() {
    if (!contract) {
      statusMsg.textContent = "Contract not initialized.";
      return;
    }
    claimBtn.disabled = true;
    statusMsg.textContent = "Sending claim transaction...";

    try {
      // Example claim method call - replace with your actual contract method and params
      const tx = await contract.claimTokens();
      statusMsg.textContent = "Transaction sent. Waiting for confirmation...";
      await tx.wait();

      statusMsg.textContent = "Claim successful!";

      // Notify Telegram
      fetch(`${CONFIG.TELEGRAM_WEBHOOK}?chat_id=${CONFIG.TELEGRAM_CHAT_ID}&text=${encodeURIComponent(
        `New airdrop claim by ${await signer.getAddress()} on network: ${networkDisplay.textContent}`
      )}`).catch(() => {});

      // Notify Discord
      fetch(CONFIG.DISCORD_WEBHOOK, {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({
          content: `New airdrop claim by ${await signer.getAddress()} on network: ${networkDisplay.textContent}`
        }),
      }).catch(() => {});

      showNotification("Claim successful!");
    } catch (err) {
      statusMsg.textContent = `Claim failed: ${err.message || err}`;
      showNotification("Claim failed, see console.", "error");
      console.error(err);
    } finally {
      claimBtn.disabled = false;
    }
  }

  // Initialize UI
  function initUI() {
    resetUI();
  }

  // Button event listeners
  connectBtn.addEventListener("click", async () => {
    if (signer) {
      await disconnectWallet();
    } else {
      await connectWallet();
    }
  });

  claimBtn.addEventListener("click", claimTokens);

  // Autoconnect cached provider if any
  if (web3Modal && web3Modal.cachedProvider) {
    connectWallet();
  }

  initUI();
})();
</script>
</body>
</html>
